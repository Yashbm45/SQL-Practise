-- Real World 
/*
🔍 Real-World SQL Problems from Top MNCs
🔸 Amazon / AWS
Customer Purchase Funnel: Identify how many customers added a product to cart but didn’t purchase.

Repeat Rate: Calculate the percentage of customers who placed more than one order within 30 days.

Prime vs Non-Prime Comparison: Compare the average order value and purchase frequency between Prime and non-Prime users (assume a user type column).

Top 10% Customers: Find customers whose total purchase amount is in the top 10% percentile.

Top Selling Product per Month: List the most sold product each month using window functions.

🔸 Microsoft
Session Identification: Given a log of page visits (by user, timestamp), identify distinct sessions (gap > 30 mins = new session).

Cohort Retention: Group users by signup month and track how many placed orders in the next 3 months.

Revenue Per Product per Country: With multiple country prices, calculate weighted average selling price.

Trending Products: Find the product with the highest week-over-week increase in sales.

Time to First Order: Calculate average time from signup to first order for all users.

🔸 Google
Click Through Rate (CTR): Calculate CTR from clicks and impressions tables.

Revenue by Traffic Source: Attribute each order to a traffic channel and analyze which performs best.

User Engagement Drops: Detect days where active users dropped by more than 20% compared to previous day.

Top Keywords Conversion: Find search keywords that lead to the most purchases.

Customer Journey Mapping: Trace user behavior across touchpoints: view → cart → purchase.

🔸 Meta (Facebook)
DAU/MAU Ratio: Compute Daily Active Users divided by Monthly Active Users.

First Interaction Attribution: Which marketing source was responsible for a user’s first interaction?

Social Graph Depth: Identify mutual friends between two users (graph-based query).

Ad Click Performance: For each ad, calculate conversion rate, revenue, and bounce rate.

Time Spent Per Feature: Average time spent by user per app feature.

🔸 Uber / Ola
Driver Utilization: Ratio of time driver is on trip vs logged in.

Idle Time Between Rides: Calculate average idle time between two trips for a driver.

Dynamic Pricing Analysis: Identify areas where ride prices surge most frequently.

Trip Cancellation Pattern: Find users/drivers with the highest cancellation rates.

Repeat Rides within City: How many users take more than 3 rides in the same city?

🔸 Flipkart / Amazon India
High Demand Products: Products that go out of stock in less than 24 hours.

Cart Abandonment Rate: Percentage of users who added to cart but didn’t order.

Return Rate by Category: Compare product return rates across categories.

Discount Impact: Does offering discount improve product purchase conversion?

Stock Optimization: Products that are frequently returned and rarely reordered.

🔸 Deloitte / Accenture / TCS (Consulting & Analytics Roles)
Client Revenue Leakage: Identify services billed below standard rates.

Consultant Utilization Rate: Hours billed / total hours logged.

Billing Gaps: Detect projects where consultants worked but were not billed.

Cross-Sell Opportunity: Clients who buy one service but not others (market basket).

Country-wise Client Growth: Year-over-year revenue growth by country.

🔸 Other Common Advanced MNC Patterns
Windowed RFM Analysis: Recency, Frequency, Monetary analysis using SQL windows.

Churn Prediction Features: Build SQL features for a churn model (last order, order gaps, spend trend).

Product Lifecycle Tracking: How long do products stay popular after launch?

Anomaly Detection in Sales: Find days where order volume deviates > 3 std deviations.

Top Influencers (Social or Referral): Users who refer others with the most conversions.

👨‍💼 Case-based and Business-oriented Scenarios
You're working for a subscription company. Identify users likely to churn based on past behavior.

As a product analyst, build an insight dashboard showing usage, drop-off, and bounce metrics.

Your manager asks: Which customer segment should we focus on to increase revenue? — use SQL to justify.

Build SQL logic to trigger alerts when a metric (e.g., order count) falls below baseline.

Design a SQL query to create a real-time sales leaderboard by category.

🎯 Want More?
I can build mock assessments, timed SQL challenges, or generate Power BI tasks based on these too (e.g., visualizations or DAX logic).

Would you like a PDF or SQL workbook version of these to practice offline or share with peers?





Attach

Search

Reason

Voice
ChatGPT can make mistakes. Check important info.
?
Help us improve your experience
*/